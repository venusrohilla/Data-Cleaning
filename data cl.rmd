```{r}
getwd()
#Loading the sales data from the link 
url_sales<-'http://s3.amazonaws.com/assets.datacamp.com/production/course_1294/datasets/sales.csv'
#Reading the data into sales
sales <- read.csv(url_sales, stringsAsFactors=F)
dim(sales)
#[put dim image]
#the number of rows are 5000 and no. of variables are 46

#for seeing the first six  starting rows and columns 
head(sales)
summary(sales)

# for finding the columns name
names(sales)
#[put names image]
#there are 46 columns with the above names
#the str function gives a good understanding of what our data type is .ie is it character ,or integer
str(sales)
#[put str part1,2 image]
library(dplyr)
#the glimpse function is similar to str function but gives us more clear  view the data type]
glimpse(sales)
#[put glimpse part1,2]
#as we can see the difference, in the out put of str the age_yr had NA vales while in the output of glimpse func we can see the null 
#avlue as well as the numeric values also
# removing the first col of sales
sales2<-sales[,-1]
str(sales2)
ncol(sales2)
#[put ncol sales2 image]
# removing not much required information
#removing first 4 columns or the last 15
keep<- seq(5,ncol(sales2)-15,1)
keep
#[put keep sales2 image]
# Subset sales2 using keep: sales3
sales3<-sales2[,keep]
glimpse(sales3)
#[put glimpse sales 3]
#as we can see the first 4 col and the last 15 col are reemoved
#separating columns
# Split event_date_time: sales4
library(tidyr)
library(stringr)
head(sales3$event_date_time)
#[put sales3 event date time]
# we can see the date and time are writen together so we need to separate it
sales4 <- separate(sales3, event_date_time, c('event_dt', 'event_time'), sep = " ")
## check new columns
col <- str_detect(names(sales4),'event')
glimpse(sales4[,col])
#[put separeted date time event]

#MBTA Ridership Data
#upload mbta2 data.xlsx 
library(readxl)
mbta <-read_xlsx("mbta(11).xlsx",skip=1) 
#examining the data
str(mbta)
#[put str mbta part1,2]
summary(mbta)
#[put summary mbta part 1,2]
#Removing unnecessry rows and columns
#Some of these rows are from analysis mixed in with the data in the excel sheet
#This is super common in excel but makes the data messy and less usable
#The first column is just the row number
## Remove rows 1 bcoz it contains many na values , 7 row bcoz it has negative values, and 11row which contains total  of mbta: mbta2
keep <- !(mbta$mode %in% c('All Modes by Qtr', 'Pct Chg / Yr', 'TOTAL'))
keep
mbta2 <- mbta[keep,]
glimpse(mbta2)
#[put glimpse mbta part1,2]
# we see now we have only 8 oiously we hab 11 obsbservations.but prev
# Remove the first column of mbta2: mbta3
mbta3 <- mbta2[,-1]
glimpse(mbta3)
#Observations are stored in columns
#This data is pretty much stored backwards
#The observation of rider count is being made each month for differnt transit types
#The month is the observation unique key and should be a column value
#The mode of transportation could be a variable and be in one column or it could be spread and have one column per type
## mbta3 is pre-loaded
head(mbta3)
View(mbta3)
# Gather columns of mbta3: mbta4
mbta4 <- gather(mbta3, month, thou_riders, -mode)
# View the head of mbta4
head(mbta4)
#[put head mbta4]
# Coerce thou_riders to numeric
mbta4$thou_riders <- as.numeric(mbta4$thou_riders)
head(mbta4)
#[put mbta 4 part2]
#earlier we had thou_riders as chr type but now they are numeric 
#Variables are stored in both rows and columns
#Here they want to spread all the modes of transportaion into separate columns
#I actually like it in a column for these reasons.
#I think of the variables as month, trasportation mode, and rider count.
#If doing a group by and summarize it needs to be in a column to group by type
#Also ggplot will require it in a column
#But The exercise is to spread it out. Though they make a chart and have to re-melt it later! : )
#But its not a big deal. Its easy to gather or spread this info based on whats needed for analysis.
## tidyr is pre-loaded
## tidyr is pre-loaded
library(tidyr)
## Spread the contents of mbta4: mbta5
mbta5 <- spread(mbta4, mode, thou_riders)
# View the head of mbta5
head(mbta5)
#[put head mbta5]
#Separating columns
# Split month column into month and year: mbta6
mbta6 <- separate(mbta5, month, c('year', 'month'))
# View the head of mbta6
head(mbta6)
# we see that in the boad col 40 is an outlier
#.plotting a histogram gives a clear view to this.
hist(mbta6$Boat)
#[put mbta boat hist 1]
#Dealing with entry error
# Find the row number of the incorrect value: i
i <- which(mbta6$Boat == 40)
# Replace the incorrect value with 4
mbta6$Boat[i] <- 4
# Generate a histogram of Boat column
hist(mbta6$Boat)
#[put mbta boat hist2]

#World Food Facts
#Importing the data
## Load data.table
library(data.table)
# Import food.csv: food
url_food <- 'http://s3.amazonaws.com/assets.datacamp.com/production/course_1294/datasets/food.csv'
food <- fread(url_food)
View(food)
# Convert food to a data frame
food <- data.frame(food)
#Examining the data
# View a glimpse of food
glimpse(food)
#[put glimpse part1,2,3]
# View column names of food
names(food)
#[put foodnames1,2]
#we wnat t limit our output
# View structure of food
str(food[,1:10])
#[put str food]
#Removing dupicate info
# Define vector of duplicate cols (don't change)
duplicates <- c(4, 6, 11, 13, 15, 17, 18, 20, 22, 
                24, 25, 28, 32, 34, 36, 38, 40, 
                44, 46, 48, 51, 54, 65, 158)
# Remove duplicates from food: food2
food2 <- food[,-duplicates]
#Removing useless info
# Define useless vector (don't change)
useless <- c(1, 2, 3, 32:41)
# Remove useless columns from food2: food3
food3 <- food2[,-useless]
#Finding columns
# Create vector of column indices: nutrition
nutrition <- str_detect(names(food3),"100g")
# View a summary of nutrition columns
summary(food3[,nutrition])
#[put summary food ,2nutri ]
# as we can see there are lot of missing values
#Replacing missing values
# Find indices of sugar NA values: missing
missing <- is.na(food3$sugars_100g)
# Replace NA values with 0
food3$sugars_100g[missing] <- 0
# Create first histogram
hist(food3$sugars_100g, breaks=100)
#[put food sugar hist]
# Create food4
food4 <- food3[food3$sugars_100g != 0, ]
# Create second histogram
hist(food4$sugars_100g, breaks=100)
#[put food hist 4]

#Dealing with messy data
#This exercise is attempting to estimate the number of food items in plastic packaging
#going back to the original food dataframe here
#packagin_tags column was removed in an earlier exercise. that maybe a mistake
# Find entries containing "plasti": plastic
plastic <- str_detect(food$packaging_tags,"plasti")
# Print the sum of plastic
sum(plastic)
#[540]
```